
#!/bin/bash


### BEGIN INIT INFO
# Provides:          plamp
# Required-Start:    $remote_fs $syslog
# Required-Stop:     $remote_fs $syslog
# Default-Start:     S
# Default-Stop:      0 1 6
# Short-Description: Plamp service
# Description:       Plamps are good
### END INIT INFO

plampdir=/home/pi/plamp

plamp_proc=plamp_socket.py

do_start() {
  # Start plamp web server and log to disk
  mkdir -p $plampdir/logs
  $plampdir/logs/plamp.log >> "STARTING"
  $plampdir/$plamp_proc > $plampdir/logs/plamp.log 2>&1 &
  return 0
}

do_stop() {
  killall -9 $plamp_proc
}

do_status() {
  /usr/bin/pgrep -fl plamp.py
}

case "$1" in
    start)
	do_start
        ;;
    status)
        do_status
        ;;
    restart|reload|force-reload)
        do_stop
        do_start
        ;;
    stop)
	do_stop
        ;;
    *)
        echo "Usage: $0 start|stop|status" >&2
        exit 3
        ;;
esac

exit 0

